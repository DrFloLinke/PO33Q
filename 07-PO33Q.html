<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 7 – PO33Q: Determinants of Democracy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-PO33Q.html" rel="next">
<link href="./05-PO33Q.html" rel="prev">
<link href="./images/Crest_white.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e2851886d12d134ff83effd9cfa02285.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<meta name="theme-color" content="#1d1f2b" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#1d1f2b" media="(prefers-color-scheme: light)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<script>
// This MUST come before the script src above
window.MathJax = {
  tex: {
    // (Quarto already sets these, but harmless to repeat)
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]'], ['$$', '$$']]
  },
  // Tell the CHTML output to use Fira
  chtml: { font: 'mathjax-fira' }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-chtml-nofont.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/Crest_white.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><span class="title-long">PO33Q – Determinants of Democracy</span> <span class="title-short">PO33Q</span></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://drfloreiche.github.io/"> 
<span class="menu-text">Flo’s Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-PO33Q.html"><span class="chapter-title">Week 7</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-PO33Q.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-PO33Q.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Quarto.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quarto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Downloads.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Downloads</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Glossary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Full Glossary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-bib.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">List of References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Week 7</h2>
   
  <ul>
  <li><a href="#road-map-for-today" id="toc-road-map-for-today" class="nav-link active" data-scroll-target="#road-map-for-today">Road Map for Today</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  </ul></li>
  <li><a href="#markov-transition-models" id="toc-markov-transition-models" class="nav-link" data-scroll-target="#markov-transition-models">Markov Transition Models</a>
  <ul class="collapse">
  <li><a href="#time-series-cross-sectional-data" id="toc-time-series-cross-sectional-data" class="nav-link" data-scroll-target="#time-series-cross-sectional-data">Time Series, Cross-Sectional Data</a></li>
  <li><a href="#what-are-markov-transition-models" id="toc-what-are-markov-transition-models" class="nav-link" data-scroll-target="#what-are-markov-transition-models">What are Markov Transition Models?</a>
  <ul class="collapse">
  <li><a href="#conditional-probabilities" id="toc-conditional-probabilities" class="nav-link" data-scroll-target="#conditional-probabilities">Conditional Probabilities</a></li>
  <li><a href="#democratic-emergence" id="toc-democratic-emergence" class="nav-link" data-scroll-target="#democratic-emergence">Democratic Emergence</a></li>
  <li><a href="#lagging-the-independent-variables" id="toc-lagging-the-independent-variables" class="nav-link" data-scroll-target="#lagging-the-independent-variables">Lagging the Independent Variables</a></li>
  <li><a href="#subsetting-the-data-for-conditional-probabilities" id="toc-subsetting-the-data-for-conditional-probabilities" class="nav-link" data-scroll-target="#subsetting-the-data-for-conditional-probabilities">Subsetting the Data for Conditional Probabilities</a></li>
  </ul></li>
  <li><a href="#democratic-emergence-1" id="toc-democratic-emergence-1" class="nav-link" data-scroll-target="#democratic-emergence-1">Democratic Emergence</a></li>
  <li><a href="#democratic-survival" id="toc-democratic-survival" class="nav-link" data-scroll-target="#democratic-survival">Democratic Survival</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  </ul></li>
  <li><a href="#model-fit-in-binary-response-models" id="toc-model-fit-in-binary-response-models" class="nav-link" data-scroll-target="#model-fit-in-binary-response-models">Model Fit in Binary Response Models</a>
  <ul class="collapse">
  <li><a href="#how-to-measure-model-fit" id="toc-how-to-measure-model-fit" class="nav-link" data-scroll-target="#how-to-measure-model-fit">How to Measure Model Fit</a>
  <ul class="collapse">
  <li><a href="#what-is-it" id="toc-what-is-it" class="nav-link" data-scroll-target="#what-is-it">What is it?</a></li>
  <li><a href="#r" id="toc-r" class="nav-link" data-scroll-target="#r">R</a></li>
  <li><a href="#emergence-full-model" id="toc-emergence-full-model" class="nav-link" data-scroll-target="#emergence-full-model">Emergence: Full Model</a></li>
  <li><a href="#survival" id="toc-survival" class="nav-link" data-scroll-target="#survival">Survival</a></li>
  <li><a href="#survival-full-model" id="toc-survival-full-model" class="nav-link" data-scroll-target="#survival-full-model">Survival: Full Model</a></li>
  </ul></li>
  <li><a href="#including-roc-in-modelsummary" id="toc-including-roc-in-modelsummary" class="nav-link" data-scroll-target="#including-roc-in-modelsummary">Including ROC in <code>modelsummary</code></a></li>
  </ul></li>
  <li><a href="#joint-estimation-of-emergence-and-survival" id="toc-joint-estimation-of-emergence-and-survival" class="nav-link" data-scroll-target="#joint-estimation-of-emergence-and-survival">Joint Estimation of Emergence and Survival</a>
  <ul class="collapse">
  <li><a href="#rationale" id="toc-rationale" class="nav-link" data-scroll-target="#rationale">Rationale</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#application-in-r" id="toc-application-in-r" class="nav-link" data-scroll-target="#application-in-r">Application in R</a></li>
  <li><a href="#literature-recommendations" id="toc-literature-recommendations" class="nav-link" data-scroll-target="#literature-recommendations">Literature Recommendations</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#the-data-set" id="toc-the-data-set" class="nav-link" data-scroll-target="#the-data-set">The Data Set</a></li>
  <li><a href="#basics" id="toc-basics" class="nav-link" data-scroll-target="#basics">Basics</a></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced">Advanced</a></li>
  </ul></li>
  <li><a href="#homework-for-week-8" id="toc-homework-for-week-8" class="nav-link" data-scroll-target="#homework-for-week-8">Homework for Week 8</a></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">Glossary</a></li>
  <li><a href="#flashcards" id="toc-flashcards" class="nav-link" data-scroll-target="#flashcards">Flashcards</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Week 7</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="road-map-for-today" class="level1 unnumbered">
<h1 class="unnumbered">Road Map for Today</h1>
<div style="height:2em;">

</div>
<table style="border-collapse: collapse; width: 60%; margin-left: auto; margin-right: auto; table-layout: fixed;">
<tbody>
<!-- The Formative -->
<tr>
<td style="border-top: 3px double currentColor !important; border-bottom: none !important; font-weight: normal; padding: 8px;">
The Formative - General Feedback
</td>
</tr>
<!-- Lecture heading -->
<tr>
<td style="border: none !important; padding: 8px;">
Lecture
</td>
</tr>
<!-- Indented subpoints -->
<tr>
<td style="border: none !important; padding: 8px 8px 8px 24px;">
Time Series
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px 8px 8px 24px;">
Markov Transition Models
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px 8px 8px 24px;">
Conditional Probabilities
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px 8px 8px 24px;">
Democratic Emergence
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px 8px 8px 24px;">
Democratic Survival
</td>
</tr>
<tr>
<td style="border: none !important; padding: 8px 8px 8px 24px;">
Model Fit
</td>
</tr>
<!-- Break -->
<tr>
<td style="border-top: 1px dashed currentColor !important; border-bottom: 1px dashed currentColor !important; padding: 8px;">
Break
</td>
</tr>
<!-- Worksheet -->
<tr>
<td style="border: none !important; border-bottom: 3px double currentColor !important; padding: 8px;">
Markov-Transition Models in R
</td>
</tr>
</tbody>
</table>
<div style="height:2em;">

</div>
<section id="learning-outcomes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h2>
<p>After this week, students should be able to:</p>
<ul>
<li>Understand and apply binary response models in the context of time-series, cross-sectional data (Markov-Transition Models)</li>
<li>Model the emergence and survival of democracy</li>
<li>Evaluate model fit for binary response models</li>
<li>Design custom lines in <code>modelsummary</code> tables</li>
</ul>
</section>
</section>
<section id="markov-transition-models" class="level1 unnumbered">
<h1 class="unnumbered">Markov Transition Models</h1>
<section id="time-series-cross-sectional-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="time-series-cross-sectional-data">Time Series, Cross-Sectional Data</h2>
<p>We are now entering the real world, as we will start to look at how characteristics vary, not only across different countries, but also across time. I have already presented the structure of time-series, cross-sectional (TSCS) data in Week 1, but to jog your memory, here it is again:</p>
<div class="custom-html-table">
<div style="width:50%; margin:auto;">
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Schematic: Time-Series, Cross-Sectional Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">literacy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">80</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">85</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">99</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>As you can see, each country has multiple observations, one for each year in which data have been observed. We will be using this information this week to calculate probabilities of regime transitions. For example, what is the probability of a country to transition from autocracy to democracy? As we only observe the regime type once for each year, this question alludes to the difference in regime type between two years in the same country. We will do this with a so-called Markov Transition Model.</p>
</section>
<section id="what-are-markov-transition-models" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="what-are-markov-transition-models">What are Markov Transition Models?</h2>
<p>A Markov Transition Model (MTM) models the probability of being a democracy in a particular year, <em>given</em> its regime type in the previous year. So, if we model the probability of a country to be a democracy this year, <em>given</em> that it was an autocracy in the previous year, we are modelling the probability of a transition from autocracy to democracy. Similarly, if we model the probability of a country to be a democracy this year, <em>given</em> that it was also a democracy in the previous year, we are modelling the probability of democratic survival. We can express these probabilities as so-called conditional probabilities.</p>
<section id="conditional-probabilities" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="conditional-probabilities">Conditional Probabilities</h3>
<p>Conditional probabilities express what I have described before in a formal way. The conditional probability to model for democratic emergence is written as follows:</p>
<p><span class="math display">\[\begin{equation}
P(y_{i,t} = 1 | y_{i, t-1} = 0)
\end{equation}\]</span></p>
<p>This reads: The probability of a country i to be a democracy (y=1) in year t, given (this is what the vertical line | says) that country i was an autocracy (y=0) in the previous year (t-1). Analogously, the conditional probability for democratic survival is:</p>
<p><span class="math display">\[\begin{equation}
P(y_{i,t} = 1 | y_{i, t-1} = 1)
\end{equation}\]</span></p>
<p>This reads: The probability of a country i to be a democracy (y=1) in year t, given that country i was also a democracy (y=1) in the previous year (t-1).</p>
<p>We will now apply this knowledge to create a model in R which calculates these conditional probabilities. Let’s start with democratic emergence.</p>
</section>
<section id="democratic-emergence" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="democratic-emergence">Democratic Emergence</h3>
<p>Democratic emergence is expressed as the probability of a country to be a democracy in year <span class="math inline">\(t\)</span>, given that it was a dictatorship in the previous year, <span class="math inline">\(t-1\)</span></p>
<p><span class="math display">\[\begin{equation*}
P(y_{i,t} = 1 | y_{i, t-1} = 0)
\end{equation*}\]</span></p>
<p>As a first step, we therefore need a variable that gives us the information which regime type each of our countries had in the previous year. We will use the <code>world</code> data set for this illustration.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"world.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now create the lagged democracy value. In order for R to know when a new country “starts”, we need to group observations by country first, and then lag the variable democracy. We do this with the intuitively called function <code>lag()</code>. We then ungroup the data again, as we have no need of the groups any more.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countrycode) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.democracy =</span> <span class="fu">lag</span>(democracy)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This creates a new variable <code>l.democracy</code> which gives us the information we were after: the regime type of the country in the previous year. Note that as the first observation for each country cannot be lagged, it creates as many missing values as we have countries in the data set. Perhaps this makes more sense with a visualisation:</p>
<p>&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/Week 7/lag_schematic.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption>Schematic of lagged variable</figcaption>
</figure>
</div>
<p>&nbsp;</p>
</section>
<section id="lagging-the-independent-variables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="lagging-the-independent-variables">Lagging the Independent Variables</h3>
<p>So far, we have lagged the dependent variable, to run an MTM. This was a <em>methodological</em> necessity. But from a <em>substantive</em> point of view it makes sense to also lag our independent variables. It is reasonable to assume, that the regime type in year <span class="math inline">\(t\)</span> depends on the state of socio-economic development in the previous year, <span class="math inline">\(t-1\)</span>. It is rare that for example a recession hits, and the country immediately changes regime type. These things need time. And this is why we will now also lag the independent variables.</p>
<p>This is the same procedure as before. For “per capita GDP” we call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countrycode) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.gdppc =</span> <span class="fu">lag</span>(gdppc)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s do the same for life expectancy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countrycode) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.life =</span> <span class="fu">lag</span>(life)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and Primary gross enrolment rate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countrycode) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.enrol_gross =</span> <span class="fu">lag</span>(enrol_gross)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="bulb">
<p>Remember when writing the assessment in general, and the methods section in particular, that lagging the independent variables is not a methodological consideration, but a substantive one. It has nothing to do with the Markov Transition Model itself.</p>
</div>
</section>
<section id="subsetting-the-data-for-conditional-probabilities" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="subsetting-the-data-for-conditional-probabilities">Subsetting the Data for Conditional Probabilities</h3>
<p>Recall that for democratic emergence we need all of those observations in which a country has been an autocracy in the previous year. We can select these in R by filtering the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>world_democ0 <span class="ot">&lt;-</span> <span class="fu">filter</span>(world, l.democracy <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Whilst we are at it, we might as well also do this for democratic survival. Here we need all observations in which <code>l.democracy == 1</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>world_democ1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(world, l.democracy <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that we are ready!</p>
</section>
</section>
<section id="democratic-emergence-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="democratic-emergence-1">Democratic Emergence</h2>
<p>Even though “Markov Transition Model” sounds very complicated, the code in R is actually no different from a “regular” probit model. The only difference is that we have selected a certain type of observations. For emergence we use the data frame <code>world_democ0</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>emergence <span class="ot">&lt;-</span> <span class="fu">glm</span>(democracy <span class="sc">~</span> l.gdppc, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> world_democ0, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.exclude,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(emergence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = democracy ~ l.gdppc, family = binomial(link = "probit"), 
    data = world_democ0, na.action = na.exclude)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.977e+00  4.668e-02 -42.360   &lt;2e-16 ***
l.gdppc     -2.413e-05  1.158e-05  -2.084   0.0372 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 950.50  on 4651  degrees of freedom
Residual deviance: 943.72  on 4650  degrees of freedom
  (725 observations deleted due to missingness)
AIC: 947.72

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Once again, we can include multiple independent variables by connecting these with <code>+</code> in the <code>glm()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>emergence_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(democracy <span class="sc">~</span> l.gdppc <span class="sc">+</span> l.life <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                          l.enrol_gross, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> world_democ0, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.action =</span> na.exclude,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(emergence_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = democracy ~ l.gdppc + l.life + l.enrol_gross, family = binomial(link = "probit"), 
    data = world_democ0, na.action = na.exclude)

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -2.717e+00  3.383e-01  -8.030 9.74e-16 ***
l.gdppc       -5.247e-05  1.991e-05  -2.635  0.00841 ** 
l.life         1.529e-02  6.975e-03   2.192  0.02840 *  
l.enrol_gross -5.761e-04  2.309e-03  -0.249  0.80300    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 792.47  on 3350  degrees of freedom
Residual deviance: 777.66  on 3347  degrees of freedom
  (2026 observations deleted due to missingness)
AIC: 785.66

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
</section>
<section id="democratic-survival" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="democratic-survival">Democratic Survival</h2>
<p>Modelling democratic survival is easy now, as we have already completed all necessary preparations. To model</p>
<p><span class="math display">\[\begin{equation*}
P(y_{i,t} = 1 | y_{i, t-1} = 1)
\end{equation*}\]</span></p>
<p>This time we use <code>world_democ1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>survival <span class="ot">&lt;-</span> <span class="fu">glm</span>(democracy <span class="sc">~</span> l.gdppc,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> world_democ1, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.exclude,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = democracy ~ l.gdppc, family = binomial(link = "probit"), 
    data = world_democ1, na.action = na.exclude)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.629e+00  7.591e-02  21.456  &lt; 2e-16 ***
l.gdppc     1.893e-04  3.608e-05   5.245 1.56e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 724.54  on 4588  degrees of freedom
Residual deviance: 626.75  on 4587  degrees of freedom
  (162 observations deleted due to missingness)
AIC: 630.75

Number of Fisher Scoring iterations: 11</code></pre>
</div>
</div>
<p>And again with all independent variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>survival_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(democracy <span class="sc">~</span> l.gdppc <span class="sc">+</span> l.life <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                         l.enrol_gross,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> world_democ1, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.action =</span> na.exclude,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survival_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = democracy ~ l.gdppc + l.life + l.enrol_gross, family = binomial(link = "probit"), 
    data = world_democ1, na.action = na.exclude)

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   8.272e-01  5.861e-01   1.411  0.15814   
l.gdppc       1.178e-04  3.745e-05   3.144  0.00166 **
l.life        7.210e-03  1.122e-02   0.642  0.52056   
l.enrol_gross 4.698e-03  3.437e-03   1.367  0.17167   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 500.81  on 3584  degrees of freedom
Residual deviance: 432.34  on 3581  degrees of freedom
  (1166 observations deleted due to missingness)
AIC: 440.34

Number of Fisher Scoring iterations: 11</code></pre>
</div>
</div>
</section>
<section id="interpretation" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>The interpretation is analogous to a cross-sectional probit model we explored in Week 3. Just bear in mind that the predicted probabilities are all indicating the probability for democracy to emerge, or for democracy to survive.</p>
</section>
</section>
<section id="model-fit-in-binary-response-models" class="level1 unnumbered">
<h1 class="unnumbered">Model Fit in Binary Response Models<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h1>
<section id="how-to-measure-model-fit" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="how-to-measure-model-fit">How to Measure Model Fit</h2>
<p>There are quite a few model fit measures around for binary response models, such as pseudo R-Squared and the Akaike Information Criterion (AIC). What I am going to present here, however, is the so-called ROC curve, as I personally really don’t like the aforementioned measures.</p>
<section id="what-is-it" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="what-is-it">What is it?</h3>
<div class="video">
<p><strong>The ROC Curve</strong></p>
<p>YouTube link to follow</p>
</div>
<p>The principle idea of ROC is to determine how well our model is able to separate cases into the two categories of our dependent variable. It approaches this question by comparing the actual observed values of the dependent variable with the values the model would predict, given the values of the independent variables.</p>
<p>Consider <a href="#fig-separation" class="quarto-xref">Figure&nbsp;<span>1</span></a> a). On the x-axis you see eight observations, marked as coloured circles. Red circles represent countries which are dictatorships, and orange ones democracies. They are sorted by their respective level of per capita GDP. Now suppose that the displayed CDF is the results of a model we have estimated. With a cut off point <span class="math inline">\(\tau=0.5\)</span> we would correctly predict the group of four observations on the left to be dictatorships. They are True Negatives (TN). The group on the right would be correctly predicted as democracies, these are True Positives (TP). We have no incorrectly classified cases; our model has been able to separate cases perfectly. You can see this represented in the form of distributions in panel b).</p>
<p>&nbsp; &nbsp;</p>
<div id="fig-separation" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-separation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="files/Week 7/separate.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-separation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Perfect Separation
</figcaption>
</figure>
</div>
<p>&nbsp; &nbsp;</p>
<p>As you well know by now, the real world is oddly deficient in achieving perfection such as this. We will observe both poor democracies, and rich dictatorships. This scenario is shown in <a href="#fig-overlap" class="quarto-xref">Figure&nbsp;<span>2</span></a> a).</p>
<p>&nbsp; &nbsp;</p>
<div id="fig-overlap" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overlap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="files/Week 7/overlap.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overlap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Overlap
</figcaption>
</figure>
</div>
<p>According to the CDF we would predict the poor democracy as a dictatorship. It would be a False Negative (FN). Conversely, we would predict the rich dictatorship as a democracy and would obtain a False Positive (FP). The distribution of cases in <a href="#fig-overlap" class="quarto-xref">Figure&nbsp;<span>2</span></a> b) is not as clearly separated any more as in <a href="#fig-separation" class="quarto-xref">Figure&nbsp;<span>1</span></a> b). Now they overlap, leading to incorrect classifications. These are marked accordingly in <a href="#fig-tntp1" class="quarto-xref">Figure&nbsp;<span>3</span></a>. As we are no longer operating in a world in which we only have TNs and TPs, I think we can all agree that our model fit is no longer as good as in <a href="#fig-separation" class="quarto-xref">Figure&nbsp;<span>1</span></a>.</p>
<div id="fig-tntp1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tntp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="files/Week 7/tntp1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tntp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: False Negatives and False Positives
</figcaption>
</figure>
</div>
<p>But there is another issue: whilst setting <span class="math inline">\(\tau\)</span> at 0.5 makes intuitive sense, there is nothing preventing us from shifting <span class="math inline">\(\tau\)</span> around. Indeed, the number of FPs and FNs very much depends on where we place our cut-off point. For example, if we don’t want any FNs, then we just have to shift <span class="math inline">\(\tau\)</span> sufficiently downwards. Or if we want to avoid FPs we only need to move it far enough upwards. I have illustrated this in <a href="#fig-taushift" class="quarto-xref">Figure&nbsp;<span>4</span></a> a) and b), respectively.</p>
<div id="fig-taushift" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-taushift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="files/Week 7/taushift.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taushift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Shifting <span class="math inline">\(\tau\)</span>
</figcaption>
</figure>
</div>
<p>&nbsp;</p>
<div class="top-bottom-rule-only">
<table style="border-collapse: collapse; border-spacing: 0; margin: auto; text-align: center; font-size: 90%; width: 60%;">
<thead>
<tr>
<th style="padding: 12px 4px;">
</th>
<th style="padding: 12px 4px;">
</th>
<th colspan="2" style="padding: 12px 4px;">
<strong>Actual</strong>
</th>
</tr>
<tr>
<th rowspan="4" style="padding: 12px 4px; vertical-align: middle;">
<strong>Predicted</strong>
</th>
<th rowspan="2" style="padding: 12px 4px; vertical-align: middle;">
<strong>Democracy</strong>
</th>
<td style="padding: 12px 4px;">
True<br>Positive
</td>
<td style="padding: 12px 4px;">
False<br>Positive
</td>
</tr>
<tr>
</tr>
<tr>
<th rowspan="2" style="padding: 12px 4px; vertical-align: middle;">
<strong>Dictatorship</strong>
</th>
<td style="padding: 12px 4px;">
False<br>Negative
</td>
<td style="padding: 12px 4px;">
True<br>Negative
</td>
</tr>
<tr>
</tr>
</thead>
</table>
</div>
<div aria-hidden="true" role="presentation" style="height:4em;width:100%;">

</div>
<p><span class="math display">\[\begin{equation}
\text{False Positive Rate}=\text{Sensitivity}=\frac{\text{False Positives}}{\text{False Positives}+\text{True Negatives}}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{align}
\text{True Positive Rate}&amp;=1-\text{Specificity}=\frac{\text{True Positives}}{\text{True Positives}+\text{False Negatives}}\\[10pt]
\text{Specificity} &amp;=1-\text{True Positive Rate}=1-\frac{\text{TP}}{\text{TP}+\text{FN}} \nonumber
\end{align}\]</span></p>
<p>&nbsp;</p>
<p>For our example the True Positive Rate (TPR) represents the proportion of correctly specified democracies. If we calculate these rates for each of our n confusion matrices, we are already reducing four quantities into two. Let’s do it. To provide a visual aid in this rather laborious process, I have created <a href="#fig-towardsroc" class="quarto-xref">Figure&nbsp;<span>5</span></a> which depicts all eight shifts.</p>
<p>&nbsp; &nbsp;</p>
<div id="fig-towardsroc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-towardsroc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="files/Week 7/towardsroc.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-towardsroc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Towards the ROC Curve
</figcaption>
</figure>
</div>
<p>&nbsp; &nbsp;</p>
<p><a href="#tbl-confuse" class="quarto-xref">Table&nbsp;<span>1</span></a> displays the confusion matrix for each of the panels in <a href="#fig-towardsroc" class="quarto-xref">Figure&nbsp;<span>5</span></a>, as well as the respective TPR and FPR (you are welcome).</p>
<p>&nbsp;</p>
<div id="tbl-confuse" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-confuse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="top-bottom-rule-only">
<table style="font-size:12px; margin-left:auto; margin-right:auto; border-collapse: collapse;">
<thead>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
a)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
b)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" style="vertical-align:middle; padding-left:6px; padding-right:6px;">
Pred.
</th>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=4
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=4
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=4
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=3
</td>
</tr>
<tr>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=0
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=0
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=0
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=1
</td>
</tr>
<tr>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=1
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=1
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=1
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0.75
</td>
</tr>
<tr>
<td colspan="7" style="height:12px; padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
c)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
d)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
</tr>
<tr>
<th rowspan="2" style="vertical-align:middle; padding-left:6px; padding-right:6px;">
Pred.
</th>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=4
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=2
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=3
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=2
</td>
</tr>
<tr>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=0
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=2
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=1
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=2
</td>
</tr>
<tr>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=1
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0.5
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=0.75
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0.5
</td>
</tr>
<tr>
<td colspan="7" style="height:12px; padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
e)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
f)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
</tr>
<tr>
<th rowspan="2" style="vertical-align:middle; padding-left:6px; padding-right:6px;">
Pred.
</th>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=3
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=1
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=3
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=0
</td>
</tr>
<tr>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=1
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=3
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=1
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=4
</td>
</tr>
<tr>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=0.75
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0.25
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=0.75
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0
</td>
</tr>
<tr>
<td colspan="7" style="height:12px; padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
g)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
h)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
</tr>
<tr>
<th rowspan="2" style="vertical-align:middle; padding-left:6px; padding-right:6px;">
Pred.
</th>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=2
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=0
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=1
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=0
</td>
</tr>
<tr>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=2
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=4
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=3
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=4
</td>
</tr>
<tr>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=0.5
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=0.25
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0
</td>
</tr>
<tr>
<td colspan="7" style="height:12px; padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
i)
</th>
<th colspan="2" style="text-align:center; padding-left:6px; padding-right:6px;">
Actual
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
</tr>
<tr>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</th>
<th style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<th style="padding-left:6px; padding-right:6px;">
</th>
<td style="padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<th rowspan="2" style="vertical-align:middle; padding-left:6px; padding-right:6px;">
Pred.
</th>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dem
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TP=0
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FP=0
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
Dic
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
FN=4
</td>
<td style="text-align:center; padding-left:6px; padding-right:6px;">
TN=4
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
</tr>
<tr>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
TPR=0
</td>
<td style="text-align:center; font-weight:bold; padding-left:6px; padding-right:6px;">
FPR=0
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
<td style="padding-left:6px; padding-right:6px;">
</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-confuse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Confusion Matrices for ROC CUrve
</figcaption>
</figure>
</div>
<p>&nbsp;</p>
<p>As we only need the TPRs and FPRs going forward, it makes sense to collect these in their own little table:</p>
<p>&nbsp;</p>
<div id="tbl-FPR" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-FPR-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="custom-html-table">
<table style="font-size:13px; margin-left:auto; margin-right:auto; border-collapse: collapse; width: 6.5cm;">
<thead>
<tr>
<th style="text-align:center;">
panel
</th>
<th style="text-align:center;">
TPR
</th>
<th style="text-align:center;">
FPR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
a
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
1.00
</td>
</tr>
<tr>
<td style="text-align:center;">
b
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
0.75
</td>
</tr>
<tr>
<td style="text-align:center;">
c
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
0.50
</td>
</tr>
<tr>
<td style="text-align:center;">
d
</td>
<td style="text-align:center;">
0.75
</td>
<td style="text-align:center;">
0.50
</td>
</tr>
<tr>
<td style="text-align:center;">
e
</td>
<td style="text-align:center;">
0.75
</td>
<td style="text-align:center;">
0.25
</td>
</tr>
<tr>
<td style="text-align:center;">
f
</td>
<td style="text-align:center;">
0.75
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
g
</td>
<td style="text-align:center;">
0.50
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
h
</td>
<td style="text-align:center;">
0.25
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
i
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-FPR-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: TPR and FPR Rates
</figcaption>
</figure>
</div>
<p>&nbsp;</p>
<p>We are nearly there! The last step is to display all these values in the form of a curve with the TPR on the y-axis, and the FPR on the x-axis. You can see the result – the ROC curve – in <a href="#fig-rocman" class="quarto-xref">Figure&nbsp;<span>6</span></a> a).</p>
<p>&nbsp;</p>
<div id="fig-rocman" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rocman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="files/Week 7/rocman.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rocman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: ROC Curve
</figcaption>
</figure>
</div>
<p>Note that I have added a diagonal where TPR = FPR. This is sometimes described as a model without independent variables. I like to think of the line as the graphical point where our model would not be able to separate between the two categories, at all. The further the ROC curve is away from the diagonal, the better our model is at separating the two categories. But there are two sides to the diagonal. We want it to be above the diagonal, as here the model is predicting 0s as 0s and 1s as 1s. Underneath, the prediction is inverse and 0s are predicted as 1s, and 1s are predicted as 0s.</p>
<p>To summarize the position of the curve into a numerical expression, the Area Under Curve (AUC) is used, as shown in <a href="#fig-rocman" class="quarto-xref">Figure&nbsp;<span>6</span></a> b). If the area is 100% we are correctly predicting everything. At 50% the model is incapable of separation, and at 0% the model gets everything wrong. This is very useful to compare different models.</p>
</section>
<section id="r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="r">R</h3>
<p>How do you do all of this in R? Let’s start with the simple emergence model. In order to calculate a ROC curve, we need a new package, called <code>pROC</code>. Install it and load it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To calculate the ROC curve, we need a few steps:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>prob_em <span class="ot">&lt;-</span> <span class="fu">predict</span>(emergence, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>world_democ0<span class="sc">$</span>prob_em <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_em)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span>(world_democ0<span class="sc">$</span>democracy, world_democ0<span class="sc">$</span>prob_em)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.5227</code></pre>
</div>
</div>
<p>What does each line do?</p>
<ul>
<li>predict the probability of democratic emergence for each observation (country year) and store them in a new vector called <code>prob_em</code>.</li>
<li>add the vector <code>prob_em</code> to the data frame <code>world_democ0</code>. In order to do this, we need to <code>unlist</code> the values in the <code>prob_em</code> vector.</li>
<li>we then call the <code>roc</code> function in which we compare the predicted probabilities (<code>world_democ0$prob_em</code>) with the actual, observed regime type (<code>world_democ0$democracy</code>) and store the result in an object called <code>roc</code></li>
<li>as a last step we calculate the area under the curve with the <code>auc()</code> function</li>
</ul>
<p>But we can also plot the ROC curve:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc1, <span class="at">print.auc =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-PO33Q_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="bulb">
<p>Note that <code>print.auc = TRUE</code> prints the numerical value into this plot. You can suppress it by setting it to <code>FALSE</code>.</p>
</div>
<p>Let’s follow this procedure for the other models.</p>
</section>
<section id="emergence-full-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="emergence-full-model">Emergence: Full Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prob_em_full <span class="ot">&lt;-</span> <span class="fu">predict</span>(emergence_full, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>world_democ0<span class="sc">$</span>prob_em_full <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_em_full)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(world_democ0<span class="sc">$</span>democracy, world_democ0<span class="sc">$</span>prob_em_full)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.5982</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc2, <span class="at">print.auc =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp; &nbsp;</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07-PO33Q_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp; &nbsp;</p>
</section>
<section id="survival" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="survival">Survival</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>prob_sur <span class="ot">&lt;-</span> <span class="fu">predict</span>(survival, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>world_democ1<span class="sc">$</span>prob_sur <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_sur)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> <span class="fu">roc</span>(world_democ1<span class="sc">$</span>democracy, world_democ1<span class="sc">$</span>prob_sur)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8341</code></pre>
</div>
</div>
<p>&nbsp; &nbsp;</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07-PO33Q_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp; &nbsp;</p>
</section>
<section id="survival-full-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="survival-full-model">Survival: Full Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>prob_sur_full <span class="ot">&lt;-</span> <span class="fu">predict</span>(survival_full, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>world_democ1<span class="sc">$</span>prob_sur_full <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_sur_full)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>roc4 <span class="ot">&lt;-</span> <span class="fu">roc</span>(world_democ1<span class="sc">$</span>democracy, world_democ1<span class="sc">$</span>prob_sur_full)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8215</code></pre>
</div>
</div>
<p>&nbsp; &nbsp;</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07-PO33Q_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp; &nbsp;</p>
</section>
</section>
<section id="including-roc-in-modelsummary" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="including-roc-in-modelsummary">Including ROC in <code>modelsummary</code></h2>
<p>When I introduced you to <code>modelsummary</code> in Week 3, I mentioned that we will be adding a model fit measure to the results table in Week 7. This model fit measure is the AUC. A properly formatted table summarising the results of all four models we have calculated would look like this:</p>
<p>&nbsp;</p>
<div class="cell">
<div id="tbl-emsur" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-emsur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_v13xnli93z92mtqrrgeb(i, j, css_id) {
          var table = document.getElementById("tinytable_v13xnli93z92mtqrrgeb");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_v13xnli93z92mtqrrgeb(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_v13xnli93z92mtqrrgeb");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '-1', j: 4 }, { i: '-1', j: 3 },  ], css_id: 'tinytable_css_lot430rr0ldb0xle7rp5',}, 
          { positions: [ { i: '-2', j: 3 }, { i: '-2', j: 2 }, { i: '-2', j: 4 },  ], css_id: 'tinytable_css_53bjqtjgu355k5lnqtbo',}, 
          { positions: [ { i: '10', j: 1 }, { i: '10', j: 4 }, { i: '10', j: 2 }, { i: '10', j: 3 },  ], css_id: 'tinytable_css_w29xw5951i9210ysd6on',}, 
          { positions: [ { i: '8', j: 3 }, { i: '8', j: 2 }, { i: '8', j: 4 }, { i: '8', j: 1 },  ], css_id: 'tinytable_css_890rh1bt3v730o9432fa',}, 
          { positions: [ { i: '2', j: 1 }, { i: '1', j: 1 }, { i: '6', j: 1 }, { i: '3', j: 1 }, { i: '5', j: 1 }, { i: '1', j: 2 }, { i: '7', j: 1 }, { i: '4', j: 1 }, { i: '9', j: 1 }, { i: '5', j: 2 }, { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '9', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '7', j: 3 }, { i: '3', j: 4 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '2', j: 4 }, { i: '7', j: 4 }, { i: '9', j: 3 }, { i: '1', j: 4 }, { i: '6', j: 4 }, { i: '4', j: 4 }, { i: '5', j: 4 }, { i: '9', j: 4 },  ], css_id: 'tinytable_css_y0muhya2jmoxchr1lunz',}, 
          { positions: [ { i: '-2', j: 1 },  ], css_id: 'tinytable_css_vvwjqn8seaftmpatyv0y',}, 
          { positions: [ { i: '-1', j: 1 }, { i: '-1', j: 2 },  ], css_id: 'tinytable_css_1c8tbzqnn5kmmzm5hvm6',}, 
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 },  ], css_id: 'tinytable_css_pd10in6se0ix87k2s1pk',}, 
          { positions: [ { i: '10', j: 0 },  ], css_id: 'tinytable_css_8f0276bi0dqs42jeje6x',}, 
          { positions: [ { i: '8', j: 0 },  ], css_id: 'tinytable_css_c5z7zwtmam3wl8bx1flx',}, 
          { positions: [ { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 }, { i: '5', j: 0 }, { i: '6', j: 0 }, { i: '7', j: 0 }, { i: '9', j: 0 },  ], css_id: 'tinytable_css_46e7ygrekaj27tr5thok',}, 
          { positions: [ { i: '-2', j: 0 },  ], css_id: 'tinytable_css_6mdp96145894iacb7zw6',}, 
          { positions: [ { i: '-1', j: 0 },  ], css_id: 'tinytable_css_88z78tv7mcjr9w1bo8sv',}, 
          { positions: [ { i: '0', j: 0 },  ], css_id: 'tinytable_css_k5sup78djxhm0958pazv',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_v13xnli93z92mtqrrgeb(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_lot430rr0ldb0xle7rp5, .table th.tinytable_css_lot430rr0ldb0xle7rp5 { text-align: center; text-align: center; }
      .table td.tinytable_css_53bjqtjgu355k5lnqtbo, .table th.tinytable_css_53bjqtjgu355k5lnqtbo { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_w29xw5951i9210ysd6on, .table th.tinytable_css_w29xw5951i9210ysd6on { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_890rh1bt3v730o9432fa, .table th.tinytable_css_890rh1bt3v730o9432fa { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_y0muhya2jmoxchr1lunz, .table th.tinytable_css_y0muhya2jmoxchr1lunz { text-align: center; }
      .table td.tinytable_css_vvwjqn8seaftmpatyv0y, .table th.tinytable_css_vvwjqn8seaftmpatyv0y { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_1c8tbzqnn5kmmzm5hvm6, .table th.tinytable_css_1c8tbzqnn5kmmzm5hvm6 { text-align: center; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_pd10in6se0ix87k2s1pk, .table th.tinytable_css_pd10in6se0ix87k2s1pk { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_8f0276bi0dqs42jeje6x, .table th.tinytable_css_8f0276bi0dqs42jeje6x { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_c5z7zwtmam3wl8bx1flx, .table th.tinytable_css_c5z7zwtmam3wl8bx1flx { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_46e7ygrekaj27tr5thok, .table th.tinytable_css_46e7ygrekaj27tr5thok { text-align: left; }
      .table td.tinytable_css_6mdp96145894iacb7zw6, .table th.tinytable_css_6mdp96145894iacb7zw6 { text-align: left; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_88z78tv7mcjr9w1bo8sv, .table th.tinytable_css_88z78tv7mcjr9w1bo8sv { text-align: left; text-align: center; }
      .table td.tinytable_css_k5sup78djxhm0958pazv, .table th.tinytable_css_k5sup78djxhm0958pazv { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_v13xnli93z92mtqrrgeb" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1" data-row="-2" data-col="0"> </th>
<th scope="col" align="center" colspan="4" data-row="-2" data-col="1">Dependent Variable:<br>Democracy</th>
</tr>
<tr>
<th scope="col" align="center" colspan="1" data-row="-1" data-col="0"> </th>
<th scope="col" align="center" colspan="2" data-row="-1" data-col="1">Emergence</th>
<th scope="col" align="center" colspan="2" data-row="-1" data-col="2">Survival</th>
</tr>
        
              <tr>
                <th scope="col" data-row="0" data-col="0"> </th>
                <th scope="col" data-row="0" data-col="1">Classical</th>
                <th scope="col" data-row="0" data-col="2">New</th>
                <th scope="col" data-row="0" data-col="3">Classical </th>
                <th scope="col" data-row="0" data-col="4">New </th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="5">+ p &lt; 0.1, * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td></tr></tfoot>
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">per capita GDP (lagged)</td>
                  <td data-row="1" data-col="1">-0.000*</td>
                  <td data-row="1" data-col="2">-0.000**</td>
                  <td data-row="1" data-col="3">0.000***</td>
                  <td data-row="1" data-col="4">0.000**</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0"></td>
                  <td data-row="2" data-col="1">(0.000)</td>
                  <td data-row="2" data-col="2">(0.000)</td>
                  <td data-row="2" data-col="3">(0.000)</td>
                  <td data-row="2" data-col="4">(0.000)</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">Life Expectancy (lagged)</td>
                  <td data-row="3" data-col="1"></td>
                  <td data-row="3" data-col="2">0.015*</td>
                  <td data-row="3" data-col="3"></td>
                  <td data-row="3" data-col="4">0.007</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0"></td>
                  <td data-row="4" data-col="1"></td>
                  <td data-row="4" data-col="2">(0.007)</td>
                  <td data-row="4" data-col="3"></td>
                  <td data-row="4" data-col="4">(0.011)</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">Gross Primary Enrollment (lagged)</td>
                  <td data-row="5" data-col="1"></td>
                  <td data-row="5" data-col="2">-0.001</td>
                  <td data-row="5" data-col="3"></td>
                  <td data-row="5" data-col="4">0.005</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0"></td>
                  <td data-row="6" data-col="1"></td>
                  <td data-row="6" data-col="2">(0.002)</td>
                  <td data-row="6" data-col="3"></td>
                  <td data-row="6" data-col="4">(0.003)</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">Intercept</td>
                  <td data-row="7" data-col="1">-1.977***</td>
                  <td data-row="7" data-col="2">-2.717***</td>
                  <td data-row="7" data-col="3">1.629***</td>
                  <td data-row="7" data-col="4">0.827</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0"></td>
                  <td data-row="8" data-col="1">(0.047)</td>
                  <td data-row="8" data-col="2">(0.338)</td>
                  <td data-row="8" data-col="3">(0.076)</td>
                  <td data-row="8" data-col="4">(0.586)</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">ROC Curve</td>
                  <td data-row="9" data-col="1">0.523</td>
                  <td data-row="9" data-col="2">0.598</td>
                  <td data-row="9" data-col="3">0.834</td>
                  <td data-row="9" data-col="4">0.821</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0">Num.Obs.</td>
                  <td data-row="10" data-col="1">4652</td>
                  <td data-row="10" data-col="2">3351</td>
                  <td data-row="10" data-col="3">4589</td>
                  <td data-row="10" data-col="4">3585</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-emsur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Democratic Emergence and Survival
</figcaption>
</figure>
</div>
</div>
<p>&nbsp;</p>
<p>How did I get this table? We start again by loading the packages <code>modelsummary</code> and <code>tinytable</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we store our models in a list</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Classical"</span>    <span class="ot">=</span> emergence,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"New"</span>          <span class="ot">=</span> emergence_full,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Classical"</span>    <span class="ot">=</span> survival,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"New"</span>          <span class="ot">=</span> survival_full</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and create the coefficient map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'l.gdppc'</span>       <span class="ot">=</span> <span class="st">'per capita GDP (lagged)'</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.life'</span>        <span class="ot">=</span> <span class="st">'Life Expectancy (lagged)'</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.enrol_gross'</span> <span class="ot">=</span> <span class="st">'Gross Primary Enrollment (lagged)'</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'(Intercept)'</span>   <span class="ot">=</span> <span class="st">'Intercept'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="warning">
<p>Note that the variable names need to match exactly those in the model.</p>
</div>
<p>To get the ROC information into the table, we need to create a custom line. For this, we create a mini data frame whose structure corresponds to that of the table. Our table has five columns, and so we need to specify information for all five columns of our custom line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'~term'</span> <span class="ot">=</span> <span class="st">'ROC Curve'</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(1)</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">auc</span>(roc1),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(2)</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">auc</span>(roc2),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(3)</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">auc</span>(roc3),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(4)</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">auc</span>(roc4)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>modelsummary</code> is very flexible when it comes to designing the layout of the final table, and we can place the custom row into the exact location we want. Here, it is the ninth row:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(rows, <span class="st">'position'</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="bulb">
<p>If you get a row on <code>NA</code>s at the bottom of the finished table, then you have counted too many rows.</p>
</div>
<p>In a last step, we include the custom row in the actual <code>modelsummary</code> code. Note that I have added a header at the top which groups the emergence and survival models.</p>
<div class="cell" data-tbl-cap="Democratic Emergence and Survival" data-tbl-label="tbl-emsur">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> cm,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">'AIC|BIC|Log.Lik|F|RMSE'</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">add_rows =</span> rows) <span class="sc">|&gt;</span>                                 <span class="co"># this is the custom row</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Emergence"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"Survival"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">|&gt;</span>     <span class="co"># this creates the header</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Dependent Variable: Democracy"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>))      <span class="co"># this creates the top line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="baser">
<details>
<summary>
Full code you can adapt for the assessment
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytable)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># store models in a list</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Classical"</span>    <span class="ot">=</span> emergence,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"New"</span>    <span class="ot">=</span> emergence_full,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Classical"</span>    <span class="ot">=</span> survival,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"New"</span>    <span class="ot">=</span> survival_full</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># write the coefficient map</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'l.gdppc'</span>    <span class="ot">=</span> <span class="st">'per capita GDP (lagged)'</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.life'</span>    <span class="ot">=</span> <span class="st">'Life Expectancy (lagged)'</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.enrol_gross'</span>    <span class="ot">=</span> <span class="st">'Gross Primary Enrollment (lagged)'</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'(Intercept)'</span> <span class="ot">=</span> <span class="st">'Intercept'</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co"># create a mini dataset with the information on the ROC curves</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">'~term'</span> <span class="ot">=</span> <span class="st">'ROC Curve'</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc1),</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(2)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc2),</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(3)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc3),</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(4)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc4)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co"># place the custom row into position in the final table</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(rows, <span class="st">'position'</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary code</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">"Democratic Emergence and Survival"</span>,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> cm,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">'AIC|BIC|Log.Lik|F|RMSE'</span>,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">escape =</span> <span class="cn">FALSE</span>,                                    <span class="co"># needed for spacer</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">notes =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">vspace{0.2</span><span class="sc">\\</span><span class="st">baselineskip}"</span>,             <span class="co"># add space before caption</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">notes_append =</span> <span class="cn">TRUE</span>)<span class="sc">|&gt;</span>                             <span class="co"># this is the custom row</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Emergence"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"Survival"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>))<span class="sc">|&gt;</span>     <span class="co"># this creates the groups</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Dependent Variable: Democracy"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>))<span class="sc">|&gt;</span>   <span class="co"># this creates the header</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_latex</span>(<span class="at">outer =</span> <span class="st">"label={tblr:regmodels}"</span>)<span class="sc">|&gt;</span>               <span class="co"># add label for crossref</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_latex</span>(<span class="at">placement=</span> <span class="st">"H"</span>)<span class="sc">|&gt;</span>                                 <span class="co"># place the table [H]ere</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_latex</span>(<span class="at">resize_width=</span> <span class="fl">0.5</span>, <span class="at">resize_direction=</span><span class="st">"both"</span>)   <span class="co"># adjust table size (% of textwidth)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</div>
</section>
</section>
<section id="joint-estimation-of-emergence-and-survival" class="level1 unnumbered">
<h1 class="unnumbered">Joint Estimation of Emergence and Survival</h1>
<section id="rationale" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="rationale">Rationale</h2>
<p>It is perfectly adequate to estimate the processes of democratic emergence and survival separately. There is a more elegant approach, however, in which emergence and survival are estimated together. This is often employed in the literature, for example in the article by <span class="citation" data-cites="boix:2003">Boix &amp; Stokes (2003)</span>. The rationale here is that the model will, overall, use more observations and therefore this might influence standard errors and thus statistical significance.</p>
<div class="bulb">
<p>As you will see, the joint estimation requires a lot of manual calculation and general faff. I am mainly showing you this here, so that you can understand the output in aforementioned articles. If you want to employ this yourself, then you could:</p>
<ul>
<li>estimate the joint model as outlined here to check statistical significance of variables</li>
<li>then estimate emergence and survival separately and work with those separately estimated models to calculate predicted probabilities and ROC curves</li>
</ul>
</div>
<p>So, what’s the setup? Again, we are incorporating the lagged value <span class="math inline">\(y_{t-1}\)</span>, to encapsulate all the history prior to period <span class="math inline">\(t\)</span>. There is just one little trick I need to introduce before we can start on the model: I will replace <span class="math inline">\(y_{t-1}\)</span> by an indicator variable <span class="math inline">\(I_{D}\)</span> in <a href="#eq-interactionmodel" class="quarto-xref">Equation&nbsp;<span>1</span></a> which assumes the value 1 if a country was a democracy in the previous year, and zero otherwise (notation adapted from Epstein et al., 2006, p.&nbsp;553). Following on from this, we can write the model as follows<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<p><span id="eq-interactionmodel"><span class="math display">\[
P(D_{i,t}) = \Phi(\beta_{0}+\beta_{1} X_{i,t} + \beta_{2} I_{D} + \beta_{3} I_{D} X_{i,t} + \epsilon_{i,t})
\qquad(1)\]</span></span></p>
<p>where <span class="math inline">\(P(D_{it})\)</span> is the probability that a country <span class="math inline">\(i\)</span> was a democracy in year <span class="math inline">\(t\)</span>, <span class="math inline">\(\Phi\)</span> is the cumulative normal distribution (the s-shaped distribution which you know from the introduction of probit in week 3), <span class="math inline">\(I_{D}\)</span> the aforementioned indicator variable, <span class="math inline">\(X_{i,t}\)</span> is an independent variable for country <span class="math inline">\(i\)</span> in year <span class="math inline">\(t\)</span>, and <span class="math inline">\(\epsilon_{i,t}\)</span> is a zero mean stochastic disturbance.</p>
<div class="warning">
<p>Please note that I am deliberately <strong>not</strong> lagging the independent variables (IVs) in the following discussion to keep notation as simple as possible. If you decide to run the interaction model, make sure you lag the IVs as explained above. I will also drop <span class="math inline">\(\epsilon_{i,t}\)</span> in what is to follow, as this is irrelevant for us here and now and I don’t want to confuse you unncessarily.</p>
</div>
<p>This model is a multiplicative interaction model which allow us to model the probability of a country to be a democracy, <em>conditional</em> on its regime type in the previous year. The indicator variable <span class="math inline">\(I_{D}\)</span>, equal to <span class="math inline">\(y_{t-1}\)</span> captures this information. How does this work?</p>
<p>Let us start by assuming that in year <span class="math inline">\(t-1\)</span> country <span class="math inline">\(i\)</span> was an autocracy. In this case, the indicator variable <span class="math inline">\(I_{D}\)</span> would be equal to zero, and therefore <a href="#eq-interactionmodel" class="quarto-xref">Equation&nbsp;<span>1</span></a> can be re-written as</p>
<p><span class="math display">\[\begin{equation}
P(D_{i,t})=\Phi(\beta_{0}+\beta_{1} X_{i,t})
\end{equation}\]</span></p>
<p>In this case, the coefficient <span class="math inline">\(\beta_{1}\)</span> would only represent the impact of variable <span class="math inline">\(X_{i,t}\)</span> on the probability of an autocracy transitioning to democracy. Expressed more formally, we are dealing with conditional probabilities here, in the case of <span class="math inline">\(\beta_{1}\)</span>, we would obtain the impact of variable <span class="math inline">\(X_{i,t}\)</span> on a country to be a democracy in year <span class="math inline">\(t\)</span>, <em>under the condition</em> that it was an autocracy in year <span class="math inline">\(t-1\)</span>. It is conditional on this, because we set the indicator variable to zero before.</p>
<p>We can construct a similar scenario for the condition, that a country was a democracy in the previous year. In this case, the indicator variable <span class="math inline">\(I_{D}\)</span> would be equal to <span class="math inline">\(1\)</span>, and we would obtain <a href="#eq-interactionmodel" class="quarto-xref">Equation&nbsp;<span>1</span></a> again:</p>
<p><span class="math display">\[\begin{equation*}
P(D_{i,t})=\Phi(\beta_{0}+\beta_{1} X_{i,t} +\beta_{2} I_{D} + \beta_{3} I_{D} X_{i,t})
\end{equation*}\]</span></p>
<p>With <span class="math inline">\(I_{D}=1\)</span>, this can be simplified to:</p>
<p><span class="math display">\[\begin{equation}
P(D_{it})=\Phi((\beta_{0} +\beta_{2}) + (\beta_{1} + \beta_{3}) X_{i,t})
\end{equation}\]</span></p>
<p>This equation illustrates very well, that the impact of variable <span class="math inline">\(X_{i,t}\)</span> on the probability of democracy to remain a democracy is now made up by the sum of the two coefficients <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{3}\)</span>, whereas the constant is the sum of coefficients <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{2}\)</span>.</p>
</section>
<section id="example" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="example">Example</h2>
<p>To make this more tangible, let’s look at an example. Assume we want to look at the effect of per capita GDP on democratic emergence (i.e.&nbsp;the transition of an autocracy to democracy), and democratic survival (i.e.&nbsp;the transition from democracy to democracy). In this case we would specify the model as follows:</p>
<p><span class="math display">\[\begin{equation}
P(D_{it})=\Phi(\beta_{0}+\beta_{1} \text{per capita GDP}_{i,t} +\beta_{2} I_{D} + \beta_{3} I_{D} \text{per capita GDP}_{i,t})
(\#eq:interaction)
\end{equation}\]</span></p>
<p>The coefficient indicating the impact of per capita GDP on democratic emergence is <span class="math inline">\(\beta_{1}\)</span>. As illustrated above, the indicator variable <span class="math inline">\(I_{D}\)</span> is zero in this case, and the equation would be reduced to</p>
<p><span class="math display">\[\begin{equation}
P(D_{it})=\Phi(\beta_{0}+\beta_{1} \text{per capita GDP}_{i,t})
\end{equation}\]</span></p>
<p>For democratic survival, the coefficient indicating the impact of per capita GDP would be the sum of coefficients <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{3}\)</span></p>
<p><span class="math display">\[\begin{equation}
P(D_{it})=\Phi((\beta_{0} +\beta_{2}) + (\beta_{1} + \beta_{3}) \text{per capita GDP}_{i,t})
\end{equation}\]</span></p>
</section>
<section id="application-in-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="application-in-r">Application in R</h2>
<p>How does all of this look in R, and how do you apply this to a real-world scenario? Let’s do this using the above example of per capita GDP in the global data set. You have already created the indicator variable <span class="math inline">\(I_{D}\)</span> in the form of the variable <code>l.democracy</code>. What we need next is a variable that captures <em><span class="math inline">\(I_{D} \text{per capita GDP}_{i,t}\)</span></em>, so that we can calculate <span class="math inline">\(\beta_{3}\)</span>. To create this variable, type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>world<span class="sc">$</span>gdppc_l.democracy <span class="ot">&lt;-</span> world<span class="sc">$</span>l.democracy <span class="sc">*</span> world<span class="sc">$</span>gdppc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we are ready to estimate the model. Remember, formally, this is written as:</p>
<p><span class="math display">\[P(D_{it})=\Phi(\beta_{0}+\beta_{1} \text{per capita GDP}_{i,t} +\beta_{2} I_{D} + \beta_{3} I_{D} \text{per capita GDP}_{i,t})\]</span></p>
<p>We replace this in the R command with the equivalent variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>joint <span class="ot">&lt;-</span> <span class="fu">glm</span>(democracy <span class="sc">~</span> gdppc <span class="sc">+</span> l.democracy <span class="sc">+</span> gdppc_l.democracy, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> world,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">na.action =</span> na.exclude,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="bulb">
<p>If you have done regression analysis before, and you worry about (multi-)collinearity in such a model, then please note that:</p>
<blockquote class="blockquote">
<p>Analysts should include all constitutive terms when specifying multiplicative interaction models except in very rare circumstances. By constitutive terms, we mean each of the elements that constitute the interaction term. Thus, X and Z are the constitutive terms in [this model: <span class="math inline">\(y=\beta_0 + \beta_1 X + \beta_2 Z + \beta_4 XZ + \epsilon\)</span>]. <span class="citation" data-cites="brambor:2006">(Brambor et al., 2006, p. 66)</span></p>
</blockquote>
</div>
<p>You should obtain the following output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(joint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = democracy ~ gdppc + l.democracy + gdppc_l.democracy, 
    family = binomial(link = "probit"), data = world, na.action = na.exclude)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -1.981e+00  4.666e-02 -42.454  &lt; 2e-16 ***
gdppc             -2.268e-05  1.103e-05  -2.056   0.0398 *  
l.democracy        3.594e+00  8.959e-02  40.117  &lt; 2e-16 ***
gdppc_l.democracy  2.123e-04  3.727e-05   5.697 1.22e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12862  on 9277  degrees of freedom
Residual deviance:  1569  on 9274  degrees of freedom
  (1150 observations deleted due to missingness)
AIC: 1577

Number of Fisher Scoring iterations: 11</code></pre>
</div>
</div>
<p>For democratic emergence, we can report the Intercept <code>(Intercept)</code> and the slope coefficient <code>gdppc</code> straight away as <span class="math inline">\(-1.981\)</span> and <span class="math inline">\(-0.0000227\)</span>, respectively. The slope coefficient is significant, as the p-value is <span class="math inline">\(&lt;0.05\)</span>. This is in line with the findings from estimating emergence separately. For democratic survival, we need to take the sum of <code>(Intercept)</code> and <code>l.democracy</code> to obtain the intercept, and <code>gdppc</code> and <code>gdppc_l.democracy</code> to obtain the slope coefficient. This calculation will yield the same coefficients as the two-stepped analysis.</p>
<p>The last step is the assessment of statistical significance. For the emergence model, we can once again interpret the output straight away. For the survival scenario, however, we need to test the hypothesis that for example <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{3}\)</span> are <em>jointly</em> different from zero. As the survival effect is a joint-venture between these two coefficients, we also need to assess their significance jointly, and not just concentrate on <span class="math inline">\(\beta_{3}\)</span>. This is the mistake <span class="citation" data-cites="prz:2000">Przeworski et al. (2000)</span> have made in their seminal book, and this is what is discussed on the first few pages of the article by <span class="citation" data-cites="epstein:2006">Epstein et al. (2006)</span>. To do this, we are using a post-estimation command which is testing the aforementioned hypothesis that <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{3}\)</span> are <em>jointly</em> different from zero, called a Wald-Test.</p>
<p>For this we need to install and load a new package, called <code>survey</code>. This is a regression term test, where you first need to state the object within which the results are stored (here: <code>joint</code>), and the two terms you want to test, preceded by a tilde and connected by a plus. Lastly we specify that we want the Wald Test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">regTermTest</span>(joint, <span class="sc">~</span>gdppc <span class="sc">+</span> gdppc_l.democracy, <span class="at">method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test for gdppc gdppc_l.democracy
 in glm(formula = democracy ~ gdppc + l.democracy + gdppc_l.democracy, 
    family = binomial(link = "probit"), data = world, na.action = na.exclude)
F =  16.30128  on  2  and  9274  df: p= 8.5676e-08 </code></pre>
</div>
</div>
<p>With <span class="math inline">\(8.5676e-08\)</span> we can reject the null hypothesis, and conclude that jointly, the slope coefficients are different from zero, and as such that per capita GDP explains democratic survival.</p>
</section>
<section id="literature-recommendations" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="literature-recommendations">Literature Recommendations</h2>
<ul>
<li><a href="https://doi.org/10.2307/2991857"><strong><span class="citation" data-cites="beck:1998">Beck et al. (1998)</span></strong></a> “Time-Series-Cross-Section Analysis with a Binary Dependent Variable” – the title says it all</li>
<li><a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=acdce03f6a768a63b4afd3b013d0050439a5355f"><strong><span class="citation" data-cites="beck:2002">Beck et al. (2002)</span></strong></a> This is more specifically for state failure</li>
<li><a href="https://www.cambridge.org/core/journals/political-analysis/article/abs/understanding-interaction-models-improving-empirical-analyses/9BA57B3720A303C61EBEC6DDFA40744B"><strong><span class="citation" data-cites="brambor:2006">Brambor et al. (2006)</span></strong></a>: This is for the Joint Estimation of Emergence and Survival</li>
</ul>
</section>
</section>
<section id="exercises" class="level1 unnumbered">
<h1 class="unnumbered">Exercises</h1>
<section id="the-data-set" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="the-data-set">The Data Set</h2>
<p> Use the data set called <code>prz.dta</code> which is available in the <a href="https://drfloreiche.github.io/PO33Q/12-Downloads.html">Downloads Section</a>. This is the data set used in the book “Democracy and Development” <span class="citation" data-cites="prz:2000">(Przeworski et al., 2000)</span>. Deposit this in an appropriate working directory and import the data set into a data frame called <code>prz</code>. You will need the <code>haven</code> package for this, as it is a Stata data set. We will only be looking at a few variables<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>:</p>
<p>&nbsp;</p>
<div id="tbl-przcode" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-przcode-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="custom-html-table" style="width: 60%; margin: 0 auto; font-size: large;">
<table style="width: 100%; border-collapse: collapse;">
<thead>
<tr style="border-top: 3px double; border-bottom: 1px solid;">
<th style="text-align: left; padding: 0.5em;">
Variable
</th>
<th style="text-align: left; padding: 0.5em;">
Label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding: 0.5em;">
democ
</td>
<td style="padding: 0.5em;">
1 if democracy, 0 otherwise
</td>
</tr>
<tr>
<td style="padding: 0.5em;">
gdpw
</td>
<td style="padding: 0.5em;">
GDP per worker
</td>
</tr>
<tr>
<td style="padding: 0.5em;">
g
</td>
<td style="padding: 0.5em;">
Growth rate
</td>
</tr>
<tr style="border-bottom: 3px double;">
<td style="padding: 0.5em;">
oil
</td>
<td style="padding: 0.5em;">
1 if oil producer, 0 otherwise
</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-przcode-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Codebook for Przeworski et al.&nbsp;(2000) Data Set
</figcaption>
</figure>
</div>
</section>
<section id="basics" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="basics">Basics</h2>
<div class="bulb">
<p>In these exercises, I am taking you step-by-step to the final Markov Transition Model. Only the code for Exercises 3 and 4 correspond to what you will be doing in the final assessment.</p>
</div>
<ol type="1">
<li><p>Run a probit model where <code>democ</code> is the dependent variable and <code>g</code>, <code>gdpw</code> and <code>oil</code> are the independent variables. Put the results in column 1 of <a href="#tbl-interactionmodels" class="quarto-xref">Table&nbsp;<span>5</span></a>. What is (possibly) wrong with this approach? Interpret the coefficients on one or two of the variables.</p></li>
<li><p>Run the same probit model as before but now include a lagged dependent variable. To create the lagged dependent variable, call:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>prz <span class="ot">&lt;-</span> prz <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">l.democ =</span> <span class="fu">lag</span>(democ)) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Put the results in column two of <a href="#tbl-interactionmodels" class="quarto-xref">Table&nbsp;<span>5</span></a>. What are we assuming by including a lagged dependent variable? Do you think that this is appropriate here?</p>
<ol start="3" type="1">
<li><p>Now estimate a probit “transition to democracy” model i.e.&nbsp;how do growth, wealth and oil affect the probability that a country is a democracy this year given that it was a dictatorship last year. We are also lagging the independent variables by one year. Put the results in column 3 of <a href="#tbl-interactionmodels" class="quarto-xref">Table&nbsp;<span>5</span></a>. Interpret the sign of the coefficients on each independent variable.</p></li>
<li><p>Now estimate a probit “survival of democracy” model i.e.&nbsp;how do (lagged) growth, wealth and oil affect the probability that a country is a democracy this year given that it was a democracy last year. Put the results in column 4 of <a href="#tbl-interactionmodels" class="quarto-xref">Table&nbsp;<span>5</span></a>. Interpret the sign of the coefficients on each independent variable.</p></li>
</ol>
</section>
<section id="advanced" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="advanced">Advanced</h2>
<p> This section draws on the <a href="https://drfloreiche.github.io/PO33Q/07-PO33Q.html#joint-estimation-of-emergence-and-survival">instructions for joint estimation</a>.</p>
<ol start="5" type="1">
<li>Now interact all the lagged independent variables with the lagged dependent variable. Estimate a fully interactive model and include all the constitutive terms. Put the results in column 5 of <a href="#tbl-interactionmodels" class="quarto-xref">Table&nbsp;<span>5</span></a>. What is the relationship between these coefficients and those in the previous two columns? Is there any extra information provided by this full interaction model that was not available from the previous two models?</li>
<li>Now consider the straight probit model, the probit model with the lagged dependent variable, and the full interaction model. Produce the ROC curve for each of these models. Interpret a point on one of these curves. What do the ROC curves tell you about the fit of these three models?</li>
</ol>
<p>You can find the populated version of <a href="#tbl-interactionmodels" class="quarto-xref">Table&nbsp;<span>5</span></a> and the corresponding RScript in the <a href="https://drfloreiche.github.io/PO33Q/12-Downloads.html">Downloads Section</a>.</p>
<p>&nbsp;</p>
<div id="tbl-interactionmodels" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-interactionmodels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="custom-html-table" style="width: 100%; margin: 0 auto; font-size: large;">
<table style="width: 100%; border-collapse: collapse;">
<thead>
<tr>
<th style="text-align: left; padding-left: 0.5em;">
</th>
<th style="text-align: center;">
Probit (static)
</th>
<th style="text-align: center;">
Probit (lagged)
</th>
<th style="text-align: center;">
Emergence
</th>
<th style="text-align: center;">
Survival
</th>
<th style="text-align: center;">
Full Interaction
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Growth
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Wealth
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Oil
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
L.Democracy
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Growth*L.Democracy
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Wealth*L.Democracy
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Oil*L.Democracy
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
Constant
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr style="border-top: 2px solid;">
<td style="text-align: left; padding-left: 0.5em;">
Observations
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: left; padding-left: 0.5em;">
ROC
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-interactionmodels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Regression Results for Lagged, Emergence, Survival, and Interaction Models
</figcaption>
</figure>
</div>
<p>&nbsp;</p>
<div class="baser">
<details>
<summary>
<code>modelsummary</code> code for the Results Table
</summary>
<p>If you haven’t had a serious stab at the exercises yourself, please close this window now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Working Directory</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="do">########################</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>()</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># PACKAGES</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="do">############</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Import Data</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="do">#############</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>prz <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"prz.dta"</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 1</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>democracy <span class="ot">&lt;-</span> <span class="fu">glm</span>(democ <span class="sc">~</span> g <span class="sc">+</span> gdpw <span class="sc">+</span> oil, </span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> prz,</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.exclude,</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 2</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>prz <span class="ot">&lt;-</span> prz <span class="sc">%&gt;%</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.democ =</span> <span class="fu">lag</span>(democ)) <span class="sc">%&gt;%</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>dynamic <span class="ot">&lt;-</span> <span class="fu">glm</span>(democ <span class="sc">~</span> g <span class="sc">+</span> gdpw <span class="sc">+</span> oil <span class="sc">+</span> l.democ, </span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> prz,</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action =</span> na.exclude,</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>)) </span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 3</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>prz <span class="ot">&lt;-</span> prz <span class="sc">%&gt;%</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.g =</span> <span class="fu">lag</span>(g)) <span class="sc">%&gt;%</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>prz <span class="ot">&lt;-</span> prz <span class="sc">%&gt;%</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.gdpw =</span> <span class="fu">lag</span>(gdpw)) <span class="sc">%&gt;%</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>prz <span class="ot">&lt;-</span> prz <span class="sc">%&gt;%</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">l.oil =</span> <span class="fu">lag</span>(oil)) <span class="sc">%&gt;%</span></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>prz_democ0 <span class="ot">&lt;-</span> <span class="fu">filter</span>(prz, l.democ<span class="sc">==</span><span class="dv">0</span>) </span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>emergence <span class="ot">&lt;-</span> <span class="fu">glm</span>(democ <span class="sc">~</span> l.g <span class="sc">+</span> l.gdpw <span class="sc">+</span> l.oil, </span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> prz_democ0,</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.exclude,</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 4</span></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>prz_democ1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(prz, l.democ<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>survive <span class="ot">&lt;-</span> <span class="fu">glm</span>(democ <span class="sc">~</span> l.g <span class="sc">+</span> l.gdpw <span class="sc">+</span> l.oil, </span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> prz_democ1,</span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action =</span> na.exclude,</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 5</span></span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>prz<span class="sc">$</span>l.democgdpw <span class="ot">&lt;-</span> prz<span class="sc">$</span>l.democ <span class="sc">*</span> prz<span class="sc">$</span>l.gdpw</span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>prz<span class="sc">$</span>l.democg <span class="ot">&lt;-</span> prz<span class="sc">$</span>l.democ <span class="sc">*</span> prz<span class="sc">$</span>l.g</span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>prz<span class="sc">$</span>l.democoil <span class="ot">&lt;-</span> prz<span class="sc">$</span>l.democ <span class="sc">*</span> prz<span class="sc">$</span>l.oil</span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>joint <span class="ot">&lt;-</span> <span class="fu">glm</span>(democ <span class="sc">~</span> l.g <span class="sc">+</span> l.gdpw <span class="sc">+</span> l.oil <span class="sc">+</span> l.democ <span class="sc">+</span> l.democg <span class="sc">+</span> l.democgdpw <span class="sc">+</span> l.democoil, </span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> prz,</span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a>             <span class="at">na.action =</span> na.exclude,</span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 6</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Democracy model: </span></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>prob_democracy <span class="ot">&lt;-</span> <span class="fu">predict</span>(democracy, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a>prz<span class="sc">$</span>prob_democracy <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_democracy)</span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a>roc_democracy <span class="ot">&lt;-</span> <span class="fu">roc</span>(prz<span class="sc">$</span>democ, prz<span class="sc">$</span>prob_democracy)</span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Dynamic Model</span></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a>prob_dynamic <span class="ot">&lt;-</span> <span class="fu">predict</span>(dynamic, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a>prz<span class="sc">$</span>prob_dynamic <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_dynamic)</span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a>roc_dynamic <span class="ot">&lt;-</span> <span class="fu">roc</span>(prz<span class="sc">$</span>democ, prz<span class="sc">$</span>prob_dynamic)</span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a><span class="co"># emergence model</span></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a>prob_emergence <span class="ot">&lt;-</span> <span class="fu">predict</span>(emergence, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a>prz_democ0<span class="sc">$</span>prob_emergence <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_emergence)</span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a>roc_emergence <span class="ot">&lt;-</span> <span class="fu">roc</span>(prz_democ0<span class="sc">$</span>democ, prz_democ0<span class="sc">$</span>prob_emergence)</span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-126"><a href="#cb41-126" aria-hidden="true" tabindex="-1"></a><span class="co"># survive model</span></span>
<span id="cb41-127"><a href="#cb41-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-128"><a href="#cb41-128" aria-hidden="true" tabindex="-1"></a>prob_survive <span class="ot">&lt;-</span> <span class="fu">predict</span>(survive, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb41-129"><a href="#cb41-129" aria-hidden="true" tabindex="-1"></a>prz_democ1<span class="sc">$</span>prob_survive <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_survive)</span>
<span id="cb41-130"><a href="#cb41-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-131"><a href="#cb41-131" aria-hidden="true" tabindex="-1"></a>roc_survive <span class="ot">&lt;-</span> <span class="fu">roc</span>(prz_democ1<span class="sc">$</span>democ, prz_democ1<span class="sc">$</span>prob_survive)</span>
<span id="cb41-132"><a href="#cb41-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-133"><a href="#cb41-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-134"><a href="#cb41-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-135"><a href="#cb41-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Joint Model</span></span>
<span id="cb41-136"><a href="#cb41-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-137"><a href="#cb41-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-138"><a href="#cb41-138" aria-hidden="true" tabindex="-1"></a>prob_joint <span class="ot">&lt;-</span> <span class="fu">predict</span>(joint, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb41-139"><a href="#cb41-139" aria-hidden="true" tabindex="-1"></a>prz<span class="sc">$</span>prob_joint <span class="ot">&lt;-</span> <span class="fu">unlist</span>(prob_joint)</span>
<span id="cb41-140"><a href="#cb41-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-141"><a href="#cb41-141" aria-hidden="true" tabindex="-1"></a>roc_joint <span class="ot">&lt;-</span> <span class="fu">roc</span>(prz<span class="sc">$</span>democ, prz<span class="sc">$</span>prob_joint)</span>
<span id="cb41-142"><a href="#cb41-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-143"><a href="#cb41-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-144"><a href="#cb41-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-145"><a href="#cb41-145" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-146"><a href="#cb41-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelsummary</span></span>
<span id="cb41-147"><a href="#cb41-147" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb41-148"><a href="#cb41-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-149"><a href="#cb41-149" aria-hidden="true" tabindex="-1"></a><span class="co"># store models in a list</span></span>
<span id="cb41-150"><a href="#cb41-150" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb41-151"><a href="#cb41-151" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Probit (static)"</span>    <span class="ot">=</span> static,</span>
<span id="cb41-152"><a href="#cb41-152" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Probit (lagged)"</span>    <span class="ot">=</span> dynamic,</span>
<span id="cb41-153"><a href="#cb41-153" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Emergence"</span>    <span class="ot">=</span> emergence,</span>
<span id="cb41-154"><a href="#cb41-154" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Survival"</span>    <span class="ot">=</span> survive,</span>
<span id="cb41-155"><a href="#cb41-155" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Full Interaction"</span>    <span class="ot">=</span> joint</span>
<span id="cb41-156"><a href="#cb41-156" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-157"><a href="#cb41-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-158"><a href="#cb41-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-159"><a href="#cb41-159" aria-hidden="true" tabindex="-1"></a><span class="co"># write the coefficient map</span></span>
<span id="cb41-160"><a href="#cb41-160" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'g'</span>    <span class="ot">=</span> <span class="st">'Growth'</span>,</span>
<span id="cb41-161"><a href="#cb41-161" aria-hidden="true" tabindex="-1"></a>        <span class="st">'gdpw'</span>    <span class="ot">=</span> <span class="st">'per capita GDP'</span>,</span>
<span id="cb41-162"><a href="#cb41-162" aria-hidden="true" tabindex="-1"></a>        <span class="st">'oil'</span>    <span class="ot">=</span> <span class="st">'Oil Exporter (Yes)'</span>,</span>
<span id="cb41-163"><a href="#cb41-163" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.g'</span>    <span class="ot">=</span> <span class="st">'Growth (lagged)'</span>,</span>
<span id="cb41-164"><a href="#cb41-164" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.gdpw'</span>    <span class="ot">=</span> <span class="st">'per capita GDP (lagged)'</span>,</span>
<span id="cb41-165"><a href="#cb41-165" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.oil'</span>    <span class="ot">=</span> <span class="st">'Oil Exports (lagged)'</span>,</span>
<span id="cb41-166"><a href="#cb41-166" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.democ'</span>    <span class="ot">=</span> <span class="st">'Democracy (lagged)'</span>,       </span>
<span id="cb41-167"><a href="#cb41-167" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.democg'</span>    <span class="ot">=</span> <span class="st">'Democracy x Growth (lagged)'</span>,  </span>
<span id="cb41-168"><a href="#cb41-168" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.democgdpw'</span>    <span class="ot">=</span> <span class="st">'Democracy x per capita GDP (lagged)'</span>,  </span>
<span id="cb41-169"><a href="#cb41-169" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l.democoil'</span>    <span class="ot">=</span> <span class="st">'Democracy x Oil Exporter (lagged)'</span>,  </span>
<span id="cb41-170"><a href="#cb41-170" aria-hidden="true" tabindex="-1"></a>        <span class="st">'(Intercept)'</span> <span class="ot">=</span> <span class="st">'Intercept'</span>)</span>
<span id="cb41-171"><a href="#cb41-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-172"><a href="#cb41-172" aria-hidden="true" tabindex="-1"></a><span class="co"># create a mini dataset with the information on the ROC curves</span></span>
<span id="cb41-173"><a href="#cb41-173" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb41-174"><a href="#cb41-174" aria-hidden="true" tabindex="-1"></a>  <span class="st">'~term'</span> <span class="ot">=</span> <span class="st">'ROC Curve'</span>,</span>
<span id="cb41-175"><a href="#cb41-175" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc_static),</span>
<span id="cb41-176"><a href="#cb41-176" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(2)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc_dynamic),</span>
<span id="cb41-177"><a href="#cb41-177" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(3)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc_emergence),</span>
<span id="cb41-178"><a href="#cb41-178" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(4)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc_survive),</span>
<span id="cb41-179"><a href="#cb41-179" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">~(5)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">auc</span>(roc_joint)</span>
<span id="cb41-180"><a href="#cb41-180" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-181"><a href="#cb41-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-182"><a href="#cb41-182" aria-hidden="true" tabindex="-1"></a><span class="co"># place the custom row into position in the final table</span></span>
<span id="cb41-183"><a href="#cb41-183" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(rows, <span class="st">'position'</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>)</span>
<span id="cb41-184"><a href="#cb41-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-185"><a href="#cb41-185" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary code</span></span>
<span id="cb41-186"><a href="#cb41-186" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models,</span>
<span id="cb41-187"><a href="#cb41-187" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">'Regression Models, data are taken from </span><span class="sc">\\</span><span class="st">citet{prz:2000}'</span>,</span>
<span id="cb41-188"><a href="#cb41-188" aria-hidden="true" tabindex="-1"></a>             <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-189"><a href="#cb41-189" aria-hidden="true" tabindex="-1"></a>             <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-190"><a href="#cb41-190" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> cm,</span>
<span id="cb41-191"><a href="#cb41-191" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">'AIC|BIC|Log.Lik|F|RMSE'</span>,</span>
<span id="cb41-192"><a href="#cb41-192" aria-hidden="true" tabindex="-1"></a>             <span class="at">notes =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">vspace{0.3</span><span class="sc">\\</span><span class="st">baselineskip}"</span>,  <span class="co"># &lt;- spacer before caption</span></span>
<span id="cb41-193"><a href="#cb41-193" aria-hidden="true" tabindex="-1"></a>             <span class="at">notes_append =</span> <span class="cn">TRUE</span>,                    <span class="co"># keep default notes + add spacer</span></span>
<span id="cb41-194"><a href="#cb41-194" aria-hidden="true" tabindex="-1"></a>             <span class="at">add_rows =</span> rows)<span class="sc">|&gt;</span>                      <span class="co"># this is the custom row</span></span>
<span id="cb41-195"><a href="#cb41-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Dependent Variable: Democracy"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))<span class="sc">|&gt;</span></span>
<span id="cb41-196"><a href="#cb41-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_latex</span>(<span class="at">resize_width=</span> <span class="fl">1.0</span>, <span class="at">resize_direction=</span><span class="st">"both"</span>)<span class="sc">|&gt;</span> </span>
<span id="cb41-197"><a href="#cb41-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_latex</span>(<span class="at">outer =</span> <span class="st">"label={tblr:test}"</span>)<span class="sc">|&gt;</span> </span>
<span id="cb41-198"><a href="#cb41-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_latex</span>(<span class="at">placement=</span> <span class="st">"H"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</div>
</section>
</section>
<section id="homework-for-week-8" class="level1 unnumbered">
<h1 class="unnumbered">Homework for Week 8</h1>
<p><strong>Students as Learners:</strong></p>
<ul>
<li>Finish this week’s worksheet</li>
<li>Read the <a href="https://rl.talis.com/3/warwick/lists/E5FA4027-27A7-AFB0-AAF4-C891BCCD83E2.html#D3AE6FE6-BC94-45C6-68DA-576418AD3AC2">required literature for Week 8</a></li>
<li>Mark the sample essay linked below. We will go through the essay in Week 8. The fully annotated version (below) will become available after the seminar in Week 8.</li>
</ul>
<p><a class="delayed-download btn btn-primary disabled" role="button" aria-disabled="true" data-path="files/Downloads/Sample Essay.pdf" data-date="2026-02-23" data-label="<img src=&quot;images/file.png&quot; class=&quot;icon-img&quot; alt=&quot;icon&quot;> Sample Essay (available from February 23)"> <img src="images/file.png" class="icon-img" alt="icon"> Sample Essay (available from February 23) </a></p>
<p><a class="delayed-download btn btn-primary disabled" role="button" aria-disabled="true" data-path="files/Downloads/88_annotated.pdf" data-date="2026-03-04" data-label="<img src=&quot;images/file.png&quot; class=&quot;icon-img&quot; alt=&quot;icon&quot;> Sample Essay Annotated (available from March 4)"> <img src="images/file.png" class="icon-img" alt="icon"> Sample Essay Annotated (available from March 4) </a></p>
<p>&nbsp;</p>
<div style="display:none;">
<p><embed src="files/Downloads/88_annotated.pdf" class="img-fluid"> <embed src="files/Downloads/Sample Essay.pdf" class="img-fluid"></p>
</div>
<div style="height:1.5em;">

</div>
<p><strong>Students as Researchers:</strong></p>
<ul>
<li>Choose the region for your summative assessment. Create an outline (A4, bullet points), summarising the content of Research Question, Theory/Literature, Hypotheses, and Methodology. Bring this to the seminar of Week 8.</li>
<li>Compose a list of questions and issues arising from this exercise for discussion.</li>
</ul>
</section>
<section id="glossary" class="level1 unnumbered">
<h1 class="unnumbered">Glossary</h1>
<p>&nbsp;</p>
<div class="glossary-table">
<div class="cell" data-tbl-colwidths="[25,75]">
<div id="tbl-glossary7" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[25,75]">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-glossary7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="cell table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dichotomous</td>
<td style="text-align: left;">Can only assume two mutually exclusive, but internally homogeneous qualitative categories</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-glossary7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Glossary Week 7
</figcaption>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="flashcards" class="level1 unnumbered">
<h1 class="unnumbered">Flashcards</h1>
<div class="flashcard">
<details>
<summary>
New Functions This Week
</summary>
<div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
<p><iframe width="100%" height="100%" src="files/flashcards/PO33Q_Week 7_New.html" frameborder="0" allowfullscreen="" style="position:absolute; top:0; left: 0"> </iframe></p>
</div>
<p>
&nbsp;
</p>
The data are available as a <a href="files/excelfiles/PO33Q_Week 7_New.csv">.csv file</a>.
</details>
</div>
<div class="flashcard">
<details>
<summary>
R Functions This Week
</summary>
<div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
<p><iframe width="100%" height="100%" src="files/flashcards/PO33Q_Week 7_All.html" frameborder="0" allowfullscreen="" style="position:absolute; top:0; left: 0"> </iframe></p>
</div>
<p>
&nbsp;
</p>
The data are available as a <a href="files/excelfiles/PO33Q_Week 7_All.csv">.csv file</a>.
</details>
</div>
<div class="flashcard">
<details>
<summary>
All R Functions on PO33Q
</summary>
<div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
<p><iframe width="100%" height="100%" src="files/flashcards/PO33Q_Week 7_Consolidate.html" frameborder="0" allowfullscreen="" style="position:absolute; top:0; left: 0"> </iframe></p>
</div>
<p>
&nbsp;
</p>
The data are available as a <a href="files/excelfiles/PO33Q_Week 7_Consolidate.csv">.csv file</a>.
</details>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-beck:2002" class="csl-entry" role="listitem">
Beck, N., Epstein, D., Jackman, S., &amp; O’Halloran, S. (2002). <em><span class="nocase">Alternative Models of Dynamics in binary Time-Series-Cross Section Models: The Example of State Failure</span></em>. <a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=acdce03f6a768a63b4afd3b013d0050439a5355f">https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=acdce03f6a768a63b4afd3b013d0050439a5355f</a>
</div>
<div id="ref-beck:1998" class="csl-entry" role="listitem">
Beck, N., Katz, J. N., &amp; Tucker, R. (1998). <span class="nocase">Taking Time Seriously: Time‑Series-Cross‑Section Analysis with a Binary Dependent Variable</span>. <em><span>American Journal of Political Science</span></em>, <em>42</em>(4), 1260‑1288. <a href="https://doi.org/10.2307/2991857">https://doi.org/10.2307/2991857</a>
</div>
<div id="ref-boix:2003" class="csl-entry" role="listitem">
Boix, C., &amp; Stokes, S. (2003). <span>Endogenous Democratization</span>. <em><span>World Politics</span></em>, <em>55</em>, 517–549. https://doi.org/<a href="https://doi.org/10.1353/wp.2003.0019">https://doi.org/10.1353/wp.2003.0019</a>
</div>
<div id="ref-brambor:2006" class="csl-entry" role="listitem">
Brambor, T., Clark, W. R., &amp; Golder, M. (2006). <span>Understanding Interaction Models: Improving Empirical Analysis</span>. <em><span>Political Analysis</span></em>, <em>14</em>, 62–83. <a href="https://doi.org/10.1093/pan/mpi014">https://doi.org/10.1093/pan/mpi014</a>
</div>
<div id="ref-epstein:2006" class="csl-entry" role="listitem">
Epstein, D. L., Bates, R., Goldstone, J., Kristensen, I., &amp; O’Halloran, S. (2006). <span>Democratic Transitions</span>. <em><span>American Journal of Political Science</span></em>, <em>50</em>(3), 551–569. <a href="https://doi.org/10.1111/j.1540-5907.2006.00201.x">https://doi.org/10.1111/j.1540-5907.2006.00201.x</a>
</div>
<div id="ref-prz:2000" class="csl-entry" role="listitem">
Przeworski, A., Alvarez, M. E., Cheibub, J. A., &amp; Limongi, F. (2000). <em><span class="nocase">Democracy and Development - Political Institutions and Well-Being in the World, 1950-1990</span></em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511804946">https://doi.org/10.1017/CBO9780511804946</a>
</div>
<div id="ref-reiche:forthcoming" class="csl-entry" role="listitem">
Reiche, F. (forthcoming). <em><span class="nocase">Introduction to Quantitative Methods in the Social Sciences</span></em>. Oxford: Oxford University Press.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This is a verbatim reproduction from <span class="citation" data-cites="reiche:forthcoming">Reiche (forthcoming)</span>. The text is based on an explanatory video by <a href="https://youtu.be/4jRBRDbJemM?si=jslp3Vwj3e6H2oSH">StatQuest with Josh Starmer</a>. All figures are copyrighted.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This discussion draws on <span class="citation" data-cites="brambor:2006">Brambor et al. (2006)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I have taken these exercises from some material written by <a href="https://mattgolder.com/">Matt Golder</a> from whom I learned all this many moons ago.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const buttons = document.querySelectorAll(".delayed-download");

    buttons.forEach(function (btn) {
      const releaseDate = new Date(btn.dataset.date);
      const now = new Date();

      if (now >= releaseDate) {
        btn.classList.remove("disabled");
        btn.setAttribute("aria-disabled", "false");
        btn.setAttribute("href", btn.dataset.path);
        btn.setAttribute("download", btn.dataset.path.split('/').pop());
        btn.innerHTML = btn.dataset.label || "📄 Download Document";
      }
    });
  });
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/drfloreiche\.github\.io\/PO33Q\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-PO33Q.html" class="pagination-link" aria-label="Week 5">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 5</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-PO33Q.html" class="pagination-link" aria-label="Week 8">
        <span class="nav-page-text"><span class="chapter-title">Week 8</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>